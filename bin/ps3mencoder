#!/usr/bin/env perl

use strict;
use warnings;

use App::PS3MEncoder;
use Getopt::Long;

$| = 1; # unbuffer output

my ($help, $test);
my $result = GetOptions(
    "help" => \$help,
    "test" => \$test,
);

if ($test) {
    @ARGV = qw(
	http://www.youtube.com/watch?v=S3XzUYd6nrU
	-prefer-ipv4
	-nocache
	-quiet
	-oac
	lavc
	-of
	lavf
	-lavfopts
	format=dvd
	-ovc
	lavc
	-lavcopts
	vcodec=mpeg2video:vbitrate=4096:threads=2:acodec=ac3:abitrate=128
	-ofps
	24000/1001
	-o
	deleteme.mpg
    );
}

my $ps3mencoder = App::PS3MEncoder->new();

if ($help) {
    $ps3mencoder->help();
} else {
    $ps3mencoder->run();
}
